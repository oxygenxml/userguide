<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="model-context-protocol">
    <title>Model Context Protocol Details</title>
    <body>
        <p>The Anthropic Model Context Protocol (MCP) is an open standard that enables developers to
      build secure, two-way connections between their data sources and AI-powered tools.</p>
    <p>You can configure a reference to an MCP configuration file in the <ph keyref="product"/>
        <menucascade>
          <uicontrol>Preferences</uicontrol>
          <uicontrol>Plugins / Oxygen AI Positron / Model Context Protocol</uicontrol>
        </menucascade> page. <uicontrol>AI Positron</uicontrol> utilizes this file to load
      extra tools that can be called by the AI engine when using the chat modes or when invoking
      custom AI actions.</p>
    <section id="section_yjc_k24_2hc">
      <title>Tool Call Security</title>
      <p><uicontrol>AI Positron</uicontrol> does not control how various tools are implemented by
        the configured MCP servers or what parameters are used by the <b>LLM</b> to call them. By
        default, whenever the LLM calls tools obtained by <uicontrol>AI Positron</uicontrol> from an
        MCP server, the end user is required to approve or reject each individual tool call in the
        Chat view.</p>
      <p>To mark a MCP server as having all tool calls safe and avoid asking the end user each time
        for permission, you need to set an extra environmental parameter in its configuration
        file:<codeblock id="codeblock_t34_424_2hc" outputclass="language-json">"env": {
        "OXYGEN_SAFE_TOOLS":"true"
      }</codeblock></p>
    </section>
    <section id="section_al3_wm4_chc">
      <title>Oxygen XML as a Local MCP Server (Experimental)</title>
      <p>When using <ph keyref="product"/> 28 or later, the entire <b>Oxygen XML</b> application can
        be configured and started from a third-party AI assistant (e.g. <uicontrol>Claude
          Desktop</uicontrol> or <uicontrol>Claude Code</uicontrol>) as a local MCP server,
        providing access to tools for calling specific AI actions, validating, editing, and
        refactoring XML documents.</p>
      <p>Configuration steps:<ol id="ul_srq_bn4_chc">
          <li>Install the <uicontrol>AI Positron</uicontrol> add-on in <ph
              keyref="product"/>. You will need to have an <uicontrol>Enterprise</uicontrol>
            distribution of <ph keyref="product"/> or buy a subscription license for it.</li>
          <li>Enable the <uicontrol>Allow running the Oxygen XML application as a local MCP server
              (Experimental)</uicontrol> option from the <uicontrol>Model Context
              Protocol</uicontrol> preferences page. You must read through the security warning and
            if suitable, accept the EULA that warns you that such a feature allows external AI
            assistants to make changes to documents by calling tools from <b>Oxygen</b>. If you
            accept the EULA and enable the setting afterwards, you can save the preferences and
            close <b>Oxygen</b>.</li>
          <li>Create a suitable MCP configuration file in the AI assistant. For Windows, it can look
            something like this:<codeblock id="codeblock_t5g_ln4_chc" outputclass="language-json">{
    "mcpServers": {
        "oxygen-mcp": {
            "command": "c:\\path\\to\\OXYGEN_INSTALL_DIR\\oxygen.bat",
            "env": {
                "OXYGEN_RUN_AS_MCP_SERVER": "true"
            } 
        }
    }
}</codeblock>and for
            Mac/Linux:<codeblock id="codeblock_erb_xn4_chc" outputclass="language-json">{
    "mcpServers": {
        "oxygen-mcp": {
            "command": "/bin/sh",
            "args": [
                "/Users/path/to/OXYGEN_INSTALL_DIR/oxygen.sh"
            ],
            "env": {
                "OXYGEN_RUN_AS_MCP_SERVER": "true"
            } 
        }
    }
}</codeblock>As a configurable feature, you can configure the <ph keyref="product"/>
            application to show a visual preview dialog box whenever its tools are used to save and
            modify content using a specific <codeph>env</codeph>
            variable:<codeblock id="codeblock_fg1_d44_chc" outputclass="language-json">{
    "mcpServers": {
        "oxygen-mcp": {
            ....
            "env": {
                "OXYGEN_RUN_AS_MCP_SERVER": "true",
                "OXYGEN_MCP_SERVER_GUI_PREVIEW_FILE_CHANGES": "true"
            } 
        }
    }
}</codeblock></li>
          <li>Restart the AI assistant. When started, it should also start the <ph keyref="product"
            /> application and gain access to all AI tools available in its installed <uicontrol>AI
              Positron</uicontrol> add-on.</li>
        </ol></p>
    </section>
    </body>
</topic>
